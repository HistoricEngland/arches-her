<!--
ARCHES - a program developed to inventory and manage immovable cultural heritage.
Copyright (C) 2013 J. Paul Getty Trust and World Monuments Fund

This program is free software: you can redistribute it and/or modify
it under the terms of the GNU Affero General Public License as
published by the Free Software Foundation, either version 3 of the
License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
GNU Affero General Public License for more details.

You should have received a copy of the GNU Affero General Public License
along with this program. If not, see <http://www.gnu.org/licenses/>.
-->

{% extends "base-manager.htm" %}
{% load staticfiles %}
{% load template_tags %}
{% load i18n %}

{% block css %}
    {{ block.super }}
    {% if 'consultations' in request.path %}
    <link href="{% static 'css/consultations.css' %}" rel="stylesheet">
    {% endif %}
{% endblock css%}


{% block body %}
    {{ block.super }}

    {% block mainnav %}
    <nav id="mainnav-container">
        <div id="mainnav">
            {% block navbar %}
            <div id="mainnav-menu-wrap">
                <div class="nano">
                    <div class="nano-content" tabindex="0">
                        <ul id="mainnav-menu" class="list-group">


                            {% if 'consultations' in request.path %}
                            
                            {% for p in plugins %}
                            <li{% if main_script == "views/plugin" and plugin.pluginid == p.pluginid  %} class="active-sub"{% endif %}>
                                {% if p.name == "Dashboard" %}
                                <a href="{% url 'plugins' p.pluginid %}" data-bind="css: {'nav-item-disabled': !inSearch() }" alt="Click Search to use Dashboard">
                                {% elif p.slug is not None %}
                                <a href="{% url 'plugins' p.slug %}" data-bind="click: navigate.bind(this, '{% url 'plugins' p.slug %}') ">
                                {% else %}
                                <a href="{% url 'plugins' p.pluginid %}" data-bind="click: navigate.bind(this, '{% url 'plugins' p.pluginid %}') ">
                                {% endif %}
                                    <i class="{{p.icon}}"></i>
                                    <span class="menu-title">
                                        {{p.name}}
                                    </span>
                                </a>
                            </li>
                            {% endfor %}

                            {% else %}

                            <!-- Tools -->
                            <li class="list-header">{% trans "Tools" %}</li>

                            <!-- System Settings list item -->
                            {% if request.user|has_group:"System Administrator" %}
                            <li{% if "views/resource" in main_script and is_system_settings is True %} class="active-sub"{% endif %}>
                                <a href="{% url 'config' %}" data-bind="click: navigate.bind(this, '{% url 'config' %}') ">
                                    <i class="ti-alarm-clock"></i>
                                    <span class="menu-title">
                                        <strong>{% trans "Manage System Settings" %}</strong>
                                    </span>
                                </a>
                                <ul class="collapse in pop-in arches" data-bind="css:{'expanded-nav': navExpanded()}">
                                    <li class="link-submenu-item">
                                        <a class="link-submenu" href="{% url 'config' %}" data-bind="click: navigate.bind(this, '{% url 'config' %}')">{% trans "System Settings" %}</a>
                                    </li>
                                    <li class="link-submenu-item">
                                        <a class="link-submenu" href="{% url 'graph' system_settings_graphid %}" data-bind="click: navigate.bind(this, '{% url 'graph_designer' system_settings_graphid %}')">{% trans "System Settings Graph" %}</a>
                                    </li>
                                </ul>
                            </li>
                            {% endif %}

                            <li{% if "views/search" in main_script %} class="active-sub"{% endif %}>
                                <a href="{% url 'search_home' %}" data-bind="click:function () { navigate('{% url 'search_home' %}') }">
                                    <i class="fa fa-search"></i>
                                    <span class="menu-title">
                                        <strong>{% trans "Search" %}</strong>
                                    </span>
                                </a>
                            </li>

                            <!--Menu list item-->
                            {% if request.user|can_edit_resource_instance %}
                            <li{% if "views/resource" in main_script and is_system_settings is False %} class="active-sub"{% endif %}>
                                <a href="{% url 'resource' %}" data-bind="click: navigate.bind(this, '{% url 'resource' %}') ">
                                    <i class="fa fa-building-o"></i>
                                    <span class="menu-title">
                                        <strong>{% trans "Add New Resource" %}</strong>
                                    </span>
                                </a>
                                <ul class="collapse in pop-in arches" data-bind="css:{'expanded-nav': navExpanded()}">
                                    <!-- ko foreach: createableResources -->
                                    <li class="link-submenu-item">
                                        <a class="link-submenu" href="#" data-bind="click: disable_instance_creation ? null: $parent.navigate.bind(this, '{% url 'add_resource' 'aaaaaaaa-aaaa-aaaa-aaaa-aaaaaaaaaaaa' %}'.replace('aaaaaaaa-aaaa-aaaa-aaaa-aaaaaaaaaaaa', graphid)),
                                            css: { 'arches-menu-item-disabled': disable_instance_creation },
                                            attr: {
                                                href: disable_instance_creation ? '#' : ('{% url 'add_resource' 'aaaaaaaa-aaaa-aaaa-aaaa-aaaaaaaaaaaa' %}'.replace('aaaaaaaa-aaaa-aaaa-aaaa-aaaaaaaaaaaa', graphid))
                                            }">
                                            <i class="fa arches-menu-icon" data-bind="css: iconclass || 'fa fa-question'"></i> <span data-bind="text:name"></span></a>
                                    </li>
                                    <!-- /ko -->
                                </ul>
                            </li>
                            {% endif %}

                            <!--Menu list item-->
                            {% if request.user|has_group:"Graph Editor" %}
                            <li{% if "views/graph" in main_script %} class="active-sub"{% endif %}>
                                <a href="#" data-bind="click: navigate.bind(this, '{% url 'graph' '' %}') ">
                                    <i class="fa fa-bookmark"></i>
                                    <span class="menu-title">
                                        <strong>{% trans "Arches Designer" %}</strong>
                                    </span>
                                </a>
                                <ul class="collapse in pop-in arches" data-bind="css:{'expanded-nav': navExpanded()}">
                                    <li class="link-submenu-item">
                                        <a class="link-submenu"  href="{% url 'graph' '' %}" data-bind="click: navigate.bind(this, '{% url 'graph' '' %}')">{% trans "Resource Models" %}</a>
                                    </li>
                                    <li class="link-submenu-item">
                                        <a class="link-submenu" href="{% url 'graph' '' %}#branches" data-bind="click: navigate.bind(this, '{% url 'graph' '' %}#branches')">{% trans "Branches" %}</a>
                                    </li>
                                </ul>
                            </li>
                            {% endif %}

                            <!--Menu list item-->
                            {% if request.user|has_group:"Application Administrator" %}
                            <li{% if "views/map-layer-manager" in main_script %} class="active-sub"{% endif %}>
                                <a href="{% url 'map_layer_manager' %}" data-bind="click: navigate.bind(this, '{% url 'map_layer_manager' %}') ">
                                    <i class="fa fa-server"></i>
                                    <span class="menu-title">
                                        <strong>{% trans "Map Layer Manager" %}</strong>
                                    </span>
                                </a>
                                <ul class="collapse in pop-in arches" data-bind="css:{'expanded-nav': navExpanded()}">
                                    <li class="link-submenu-item">
                                        <a class="link-submenu" href="{% url 'map_layer_manager' %}" data-bind="click: navigate.bind(this, '{% url 'map_layer_manager' %}')">{% trans "Resource Layers" %}</a>
                                    </li>
                                    <li class="link-submenu-item">
                                        <a class="link-submenu" href="{% url 'map_layer_manager' %}#basemaps" data-bind="click: navigate.bind(this, '{% url 'map_layer_manager' %}#basemaps')">{% trans "Basemaps" %}</a>
                                    </li>
                                    <li class="link-submenu-item">
                                        <a class="link-submenu" href="{% url 'map_layer_manager' %}#overlays" data-bind="click: navigate.bind(this, '{% url 'map_layer_manager' %}#overlays')">{% trans "Overlays" %}</a>
                                    </li>
                                </ul>
                            </li>

                            <li{% if "views/mobile-survey-manager" in main_script %} class="active-sub"{% endif %}>
                                <a href="{% url 'collector_manager' %}" data-bind="click: navigate.bind(this, '{% url 'collector_manager' %}') ">
                                    <i class="fa fa-globe"></i>
                                    <span class="menu-title">
                                        <strong>{% trans "Arches Collector Manager" %}</strong>
                                    </span>
                                </a>
                            </li>
                            {% endif %}


                            <!-- Recently Added -->
                            {% if request.user|can_edit_resource_instance %}
                            <li{% if 'edit-history' in main_script %} class="active-sub"{% endif %}>
                                <a href="{% url 'edit_history' %}" data-bind="click: navigate.bind(this, '{% url 'edit_history' %}') ">
                                    <i class="ti-ticket"></i>
                                    <span class="menu-title">
                                        <strong>{% trans "Recent Edits" %}</strong>
                                    </span>
                                </a>
                            </li>
                            {% endif %}

                            <!-- Profile Manager -->
                            {% if user.is_authenticated and request.user.username != 'anonymous' %}
                            <li{% if "user-profile-manager" in main_script %} class="active-sub"{% endif %}>
                                <a href="{% url 'user_profile_manager' %}" data-bind="click: navigate.bind(this, '{% url 'user_profile_manager' %}') ">
                                    <i class="fa fa-user"></i>
                                    <span class="menu-title">
                                        <strong>{% trans "Profile Manager" %}</strong>
                                    </span>
                                </a>
                            </li>
                            {% endif %}

                            <li class="list-divider-dark"></li>

                            <!-- Tools -->
                            <li class="list-header">{% trans "Modules" %}</li>

                            {% if request.user|has_group:"RDM Administrator" %}
                            <!--Menu list item-->
                            <li{% if main_script == "rdm" %} class="active-sub"{% endif %}>
                                <a href="{% url 'rdm' '' %}" data-bind="click: navigate.bind(this, '{% url 'rdm' '' %}') ">
                                    <i class="fa fa-align-left"></i>
                                    <span class="menu-title">
                                        {% trans "Reference Data Manager" %}
                                    </span>
                                </a>
                            </li>
                            {% endif %}

                            {% for p in plugins %}
                            <li{% if main_script == "views/plugin" and plugin.pluginid == p.pluginid  %} class="active-sub"{% endif %}>
                                {% if p.name == "Dashboard" %}
                                <a href="{% url 'plugins' p.pluginid %}" data-bind="css: {'nav-item-disabled': !inSearch() }" alt="Click Search to use Dashboard">
                                {% elif p.slug is not None %}
                                <a href="{% url 'plugins' p.slug %}" data-bind="click: navigate.bind(this, '{% url 'plugins' p.slug %}') ">
                                {% else %}
                                <a href="{% url 'plugins' p.pluginid %}" data-bind="click: navigate.bind(this, '{% url 'plugins' p.pluginid %}') ">
                                {% endif %}
                                    <i class="{{p.icon}}"></i>
                                    <span class="menu-title">
                                        {{p.name}}
                                    </span>
                                </a>
                            </li>
                            {% endfor %}

                            {% endif %}
                        </ul>
                    </div>
                </div>
            </div>
            {% endblock navbar %}
        </div>
    </nav>
    {% endblock mainnav %}


{% endblock body %}

